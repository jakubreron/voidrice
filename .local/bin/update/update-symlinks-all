#!/bin/sh

log() {
  message="$1"
  echo -e "\033[1m‚è≥ $message...\033[0m"
}

replace_stow() {
  command="stow --adopt --target=$HOME --dir=$DOTFILES_DIR"

  log "Updating Dotfiles Symlinks"
  [ -d "$DOTFILES_DIR/voidrice" ] && $command voidrice
  [ -d "$DOTFILES_DIR/universal" ] && $command universal

  if [[ $OSTYPE == 'darwin'* ]]; then
    [ -d "$DOTFILES_DIR/macos" ] && $command macos
  fi
}

replace_firefox_symlinks() {
  dotfiles_userjs_path="$DOTFILES_DIR/voidrice/.config/firefox/larbs.js"

  if [[ -f "$dotfiles_userjs_path" ]]; then
    log "Updating Firefox Symlinks"
    if [[ $OSTYPE == 'linux'* ]]; then
      firefox_userjs_path="~/.mozilla/firefox/*dev-edition-*"
      [[ -d "$firefox_userjs_path" ]] && ln -sf "$dotfiles_userjs_path" "$firefox_userjs_path/user-overrides.js"
    else
      firefox_userjs_path="~/Library/Application\ Support/Firefox/Profiles/*.default-*"
      [[ -d ""$firefox_userjs_path ]] && ln -sf "$dotfiles_userjs_path" "$firefox_userjs_path/user-overrides.js"
    fi
  fi

}

replace_stow
replace_firefox_symlinks
