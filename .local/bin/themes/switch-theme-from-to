#!/usr/bin/env bash

# NOTE: can be mocha, latte, macchiato, frappe
switch_from="${1:-mocha}"
switch_to="${2:-latte}"

lowercase_paths="$HOME/.config/alacritty/alacritty.yml
  $HOME/.config/rofi/config.rasi
  $HOME/.config/lvim/lua/user/builtin/init.lua
  $HOME/.config/btop/btop.conf
  $HOME/.config/fcitx5/conf/classicui.conf
  $HOME/.config/waybar/style.css
  $HOME/.config/tmux/tmux.conf
  $HOME/.config/bat/config
  $HOME/.config/BetterDiscord/data/stable/custom.css
"
uppercase_paths="$HOME/.config/Kvantum/kvantum.kvconfig"

for path in "${lowercase_paths[@]}"; do
  sed --in-place --follow-symlinks "s/$switch_from/$switch_to/" $path
done

for path in "${uppercase_paths[@]}"; do
  sed --in-place --follow-symlinks "s/${switch_from^}/${switch_to^}/" $path
done

# Dunst has different approach
ln -fs ~/.config/dunst/themes/catppuccin/src/$switch_to.conf ~/.config/dunst/dunstrc.d/99-theme.conf

# Reload all after lowercase_paths changes
killall dunst && sleep 1 && nohup dunst &

if pgrep -f "tmux" > /dev/null; then
  tmux source-file ~/.config/tmux/tmux.conf
fi
