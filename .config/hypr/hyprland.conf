# This is an example Hyprland config file.
# Refer to the wiki for more information.

# Please note not all available settings / options are set here.
# For a full list, see the wiki

# See https://wiki.hyprland.org/Configuring/Monitors/
# TODO: configure monitors when docking to the station, etc
# https://wiki.hyprland.org/Configuring/Expanding-functionality/
# monitor=LVDS-1,1920x1080,0x0,1
# monitor=DP-2,1920x1080@60,1920x0,1
monitor=,preferred,auto,1

# See https://wiki.hyprland.org/Configuring/Keywords/ for more

# Execute your favorite apps at launch
exec-once = $NOTIFICATION_DAEMON
exec-once = hyprpaper
exec-once = waybar-wrapper
exec-once = /usr/lib/polkit-kde-authentication-agent-1 
exec-once = keyd-application-mapper -d 

exec-once = fcitx
exec-once = easyeffects --gapplication-service 
exec-once = grive --path $CLOUD_DIR
exec-once = git-sync-repos global

exec-once = entr-watch
exec-once = /usr/lib/kdeconnectd
exec-once = $TORRENTS_DAEMON

# Source a file (multi-file configs)
# source = ~/.config/hypr/myColors.conf

# Some default env vars.
env = XCURSOR_SIZE,24

general {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    gaps_in = 3
    gaps_out = 6
    border_size = 2

    col.active_border = rgb(bd93f9) rgb(44475a) 90deg
    col.inactive_border = rgba(44475aaa)
    col.group_border = rgba(282a36dd)
    col.group_border_active = rgb(bd93f9) rgb(44475a) 90deg
    # non-gradient alternative
    #col.active_border = rgb(bd93f9)
    #col.inactive_border = rgba(44475aaa)
    #col.group_border = rgba(282a36dd)
    #col.group_border_active = rgb(bd93f9)

    layout = master
    cursor_inactive_timeout = 3
}


# For all categories, see https://wiki.hyprland.org/Configuring/Variables/
input {
    kb_layout = pl
    follow_mouse = 1

    touchpad {
        natural_scroll = false
    }

    repeat_rate = 50
    repeat_delay = 250
}

decoration {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    rounding = 4
    drop_shadow = yes
    shadow_range = 60
    shadow_scale = 0.97
    shadow_offset = 1 2
    shadow_render_power = 3
    col.shadow = rgba(1a1a1aee)

    inactive_opacity = 0.96

    blur {
      enabled = false
    }
}

animations {
  enabled = yes
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows,     1, 6, myBezier
    animation = windowsOut,  1, 6, default, popin 80%
    animation = border,      1, 8, default
    animation = borderangle, 1, 6, default
    animation = fade,        1, 6, default
    animation = workspaces,  1, 6, default
    # smooth window drag
    animation = windowsIn,   1, 4, myBezier, popin 50%
    animation = windowsMove, 1, 4, default
}

dwindle {
    # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
    pseudotile = true # master switch for pseudotiling. Enabling is bound to MODKEY + P in the keybinds section below
    preserve_split = true # you probably want this
}

master {
    # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
    # no_gaps_when_only = true
    always_center_master = true
    mfact = 0.65
}

gestures {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more
}

misc {
  force_hypr_chan = true
  enable_swallow = true
}

# Example per-device config
# See https://wiki.hyprland.org/Configuring/Keywords/#per-device-input-configs for more
device:lenovo-trackpoint-keyboard-ii-1 {
    sensitivity = -0.5
}
device:lenovo-trackpoint-keyboard-ii-2 {
    sensitivity = -0.5
}
device:tpps//1-ibm-trackpoint {
    sensitivity = -0.45
}
device:tpps/2-ibm-trackpoint {
    sensitivity = -0.45
}

# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more
windowrulev2 = noshadow, fullscreen:1

windowrule = workspace 3,        title:cli_mail_client
windowrule = workspace 4,        Anki
windowrule = workspace 7 silent, discord
windowrule = workspace 8,        title:cli_stocks_app
windowrule = workspace 8,        title:cli_crypto_app
windowrule = workspace 9,        easyeffects
windowrule = workspace 9,        KeePassXC

windowrulev2 = opacity 0.0 override 0.0 override,class:^(xwaylandvideobridge)$
windowrulev2 = noanim,class:^(xwaylandvideobridge)$
windowrulev2 = nofocus,class:^(xwaylandvideobridge)$
windowrulev2 = noinitialfocus,class:^(xwaylandvideobridge)$

# See https://wiki.hyprland.org/Configuring/Keywords/ for more
# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more
$MODKEY = SUPER

bind = $MODKEY,       grave,      exec, daemonable-terminal-instance --title cli_weather_app --command $CLI_WEATHER_APP
bind = $MODKEY SHIFT, grave,      exec, mute-mpd

bind = $MODKEY,       j,      layoutmsg, cyclenext
bind = $MODKEY SHIFT,       j,      layoutmsg, swapnext
bind = $MODKEY,       k,      layoutmsg, cycleprev
bind = $MODKEY SHIFT,       k,      layoutmsg, swapprev

bind = $MODKEY,       a,      layoutmsg, addmaster
bind = $MODKEY SHIFT, a,      layoutmsg, removemaster

bind = $MODKEY,       h,      splitratio, -0.04
bind = $MODKEY SHIFT, h,      splitratio, -0.08
bind = $MODKEY,       l,      splitratio, +0.04
bind = $MODKEY SHIFT, l,      splitratio, +0.08

bind = $MODKEY,       q,      killactive
bind = $MODKEY SHIFT, q,      exec, rofi-killall

# TODO: verify
# bind = $MODKEY,       comma,  focusmonitor, left
# bind = $MODKEY,       period, focusmonitor, right
# bind = $MODKEY SHIFT, comma,  movewindow, mon:left
# bind = $MODKEY SHIFT, period, movewindow, mon:right

bind = $MODKEY, minus,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bind = $MODKEY SHIFT, minus,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 15%-
bind = $MODKEY, equal,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bind = $MODKEY SHIFT, equal,  exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 15%+

bind = $MODKEY, backspace,  exec, rofi-power-menu-hyprland
bind = $MODKEY SHIFT, backspace,  exec, systemctl suspend -i

bind = $MODKEY,       Return, exec, daemonable-terminal-instance
bind = $MODKEY SHIFT, Return, exec, daemonable-terminal-instance --command $EDITOR

bind = $MODKEY,       w,      exec, $BROWSER
bind = $MODKEY SHIFT, w,      exec, $BACKUP_BROWSER

bind = $MODKEY,       t,      layoutmsg, orientationleft
bind = $MODKEY SHIFT, t,      layoutmsg, orientationtop

bind = $MODKEY,       y,      layoutmsg, orientationcenter
# bind = $MODKEY SHIFT, y,      layoutmsg,

# bind = $MODKEY,       u,      layoutmsg, 
# bind = $MODKEY SHIFT, u,      layoutmsg,

bind = $MODKEY,       i,      exec, light -A 10; ddcutil --display 1 setvcp 10 + 15
bind = $MODKEY SHIFT, i,      exec, light -U 10; ddcutil --display 1 setvcp 10 - 15

bind = $MODKEY,       e,      exec, daemonable-terminal-instance --title cli_mail_client --command $CLI_MAIL_CLIENT; rmdir ~/.abook 2>/dev/null; mw -Y
bind = $MODKEY SHIFT, e,      exec, recheck-mail

bind = $MODKEY,       o,      exec, daemonable-terminal-instance --command $CLI_FILE_EXPLORER
bind = $MODKEY SHIFT, o,      exec, daemonable-terminal-instance --command $CLI_SYSTEM_MONITOR

bind = $MODKEY,       p,      exec, mpc toggle
bind = $MODKEY SHIFT, p,      exec, playerctl play-pause

bind = $MODKEY,       bracketleft,      exec, mpc seek -10
bind = $MODKEY SHIFT, bracketleft,      exec, mpc seek -60

bind = $MODKEY,       bracketright,      exec, mpc seek +10
bind = $MODKEY SHIFT, bracketright,      exec, mpc seek +60

bind = $MODKEY,       backslash,      exec, dunstctl close
bind = $MODKEY SHIFT, backslash,      exec, dunstctl history-pop

bind = $MODKEY,       slash,      exec, rofi-website-bookmarks
bind = $MODKEY SHIFT, slash,      exec, rofi-websearch

bind = $MODKEY,       s,      exec, rofi-maimpick
bind = $MODKEY SHIFT, s,      exec, maim -s | xclip -selection clipboard -t image/png

bind = $MODKEY,       r,      exec, rofi -show drun -show-icons
bind = $MODKEY SHIFT, r,      exec, rofi -modi emoji -show emoji

bind = $MODKEY,       d,      exec, layout-builtin-only.sh
bind = $MODKEY SHIFT, d,      exec, layout-external-only.sh

bind = $MODKEY,       f,      fullscreen,
bind = $MODKEY SHIFT, f,      togglefloating,

# NOTE: already bound to gazou
# bind = $MODKEY,       apostrophe,      exec, ...,
# bind = $MODKEY SHIFT, apostrophe,      exec, ...,

bind = $MODKEY,       z,      exec, mpc prev
bind = $MODKEY SHIFT, z,      exec, playerctl previous
bind = $MODKEY,       x,      exec, mpc next
bind = $MODKEY SHIFT, x,      exec, playerctl next

bind = $MODKEY, c,      exec, rofi -show calc -modi calc -no-show-match -no-sort
bind = $MODKEY SHIFT,       c,      exec, daemonable-terminal-instance --command $CLI_NETWORK_MANAGER

bind = $MODKEY,       b,      exec, rofi-bluetooth
bind = $MODKEY SHIFT, b,      exec, rofi-layout

bind = $MODKEY,       n,      exec, daemonable-terminal-instance --command $EDITOR -c VimwikiIndex
bind = $MODKEY SHIFT, n,      exec, daemonable-terminal-instance --command $EDITOR $VIMWIKI_DIR/Scratchpad.md

bind = $MODKEY,       m,      exec, daemonable-terminal-instance --command $CLI_MUSIC_PLAYER
bind = $MODKEY SHIFT, m,      exec, daemonable-terminal-instance --command $CLI_SOUND_MANAGER

bind = $MODKEY,       f1,      exec, daemonable-terminal-instance --title cli_stocks_app --command $CLI_STOCKS_APP
bind = $MODKEY SHIFT, f1,      exec, daemonable-terminal-instance --title cli_crypto_app --command $CLI_CRYPTO_APP
bind = $MODKEY,       f2,      exec, daemonable-terminal-instance --title cli_torrents_manager --command $CLI_TORRENTS_MANAGER -X
bind = $MODKEY SHIFT, f2,      exec, daemonable-terminal-instance --title cli_network_traffic --command $CLI_NETWORK_TRAFFIC
bind = $MODKEY,       f3,      exec, mute-audio
bind = $MODKEY SHIFT, f3,      exec, mute-microphone

bind = $MODKEY,       f9,      exec, daemonable-terminal-instance --command abook -C ~/.config/abook/abookrc --datafile ~/.config/abook/addressbook
bind = $MODKEY,       f10,     exec, killall screenkey || screenkey &
bind = $MODKEY,       f11,     exec, webcam-preview
bind = $MODKEY,       F12,     exec, ~/.config/hypr/gamemode.sh

bind = $MODKEY,       space,   layoutmsg, swapwithmaster
# TODO: find other bind
# bind = $MODKEY SHIFT,       space,   layoutmsg, pin

# TODO: find other binds
# bind = $MODKEY,       tab,      layoutmsg, focuscurrentorlast
# bind = $MODKEY SHIFT,       tab,      layoutmsg, focuscurrentorlast

bind = $MODKEY,       v,   layoutmsg, focusmaster
bind = $MODKEY SHIFT, v,   layoutmsg, swapwithmaster

bind = ,              print,   exec, maim ~/Pictures/Screenshots/pic-full-$(date '+%y%m%d-%H%M-%S').png

bind = $MODKEY,       print,   exec, rofi-record
bind = $MODKEY SHIFT, print,   exec, rofi-record kill

# Switch workspaces with MODKEY + [0-9]
bind = $MODKEY,       1,      workspace, 1
bind = $MODKEY,       2,      workspace, 2
bind = $MODKEY,       3,      workspace, 3
bind = $MODKEY,       4,      workspace, 4
bind = $MODKEY,       5,      workspace, 5
bind = $MODKEY,       6,      workspace, 6
bind = $MODKEY,       7,      workspace, 7
bind = $MODKEY,       8,      workspace, 8
bind = $MODKEY,       9,      workspace, 9
bind = $MODKEY,       0,      workspace, 10

# Move active window to a workspace with MODKEY + SHIFT + [0-9]
bind = $MODKEY SHIFT, 1,      movetoworkspace, 1
bind = $MODKEY SHIFT, 2,      movetoworkspace, 2
bind = $MODKEY SHIFT, 3,      movetoworkspace, 3
bind = $MODKEY SHIFT, 4,      movetoworkspace, 4
bind = $MODKEY SHIFT, 5,      movetoworkspace, 5
bind = $MODKEY SHIFT, 6,      movetoworkspace, 6
bind = $MODKEY SHIFT, 7,      movetoworkspace, 7
bind = $MODKEY SHIFT, 8,      movetoworkspace, 8
bind = $MODKEY SHIFT, 9,      movetoworkspace, 9
bind = $MODKEY SHIFT, 0,      movetoworkspace, 10

bind = $MODKEY,             g,       workspace, e-1
bind = $MODKEY SHIFT,       g,       movetoworkspace, e-1
bind = $MODKEY,             semicolon,       workspace, e+1
bind = $MODKEY SHIFT,       semicolon,       movetoworkspace, e+1

# Move/resize windows with MODKEY + LMB/RMB and dragging
bindm = $MODKEY,      mouse:272,      movewindow
bindm = $MODKEY,      mouse:273,      resizewindow

bind = , xf86audiomicmute, exec, mute-microphone
bind = , xf86audiomute, exec, mute-audio
bind = , xf86audioraisevolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bind = , xf86audiolowervolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bind = , xf86audioprev,		exec,	playerctl previous
bind = , xf86audionext,		exec, playerctl next
bind = , xf86audiopause,	exec,	playerctl play-pause
bind = , xf86audioplay,		exec,	playerctl play-pause
bind = , xf86audiostop,		exec,	playerctl stop
bind = , xf86audiorewind,	exec,	playerctl position -10
bind = , xf86audioforward,exec, playerctl position +10
bind = , xf86poweroff,		exec,		  rofi-power-menu
bind = , xf86calculator,		exec,		rofi -show calc -modi calc -no-show-match -no-sort
bind = , xf86sleep,		exec, sudo -A zzz	
bind = , xf86mail,		exec,		daemonable-terminal-instance --title cli_mail_client --command $CLI_MAIL_CLIENT; rmdir ~/.abook; mw -Y
bind = , xf86mycomputer,		exec,		daemonable-terminal-instance --command $CLI_FILE_EXPLORER
bind = , xf86monbrightnessup,	exec,		light -A 10; ddcutil --display 1 setvcp 10 + 15
bind = , xf86monbrightnessdown,	exec,		light -U 10; ddcutil --display 1 setvcp 10 - 15

# TODO: maybe execute some powerplan mode, I have this key
# bind = , xf86battery,		exec, 

# TODO: bind these
# bind = , xf86touchpadtoggle,	exec,	(synclient | grep 'TouchpadOff.*1' && synclient TouchpadOff=0) || synclient TouchpadOff=1
# bind = , xf86touchpadoff,	exec, synclient TouchpadOff=1	
# bind = , xf86touchpadon,		exec,	synclient TouchpadOff=0	
