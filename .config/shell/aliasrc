#!/bin/sh
source ~/.config/shell/aliasrc.all

if [[ $OSTYPE == 'linux'* ]]; then
  source ~/.config/shell/aliasrc.linux
else
  # bloated mac
  source ~/.config/shell/aliasrc.osx
fi

# sudo not required for some system commands
for command in mount umount sv pacman updatedb su shutdown poweroff reboot ; do
  alias $command="sudo $command"
done; unset command

# These common commands are just too long! Abbreviate them.
alias \
  ka="killall" \
  e="sudoedit" \
  v="$EDITOR" \
  p="$PACKAGE_MANAGER" \
  pkgs="pkgstats search" \
  ud="updatedb"

# generate & sync packages
# arch / pacman / paru
alias \
  gen-pkg-main-pacman="cd $PKGLIST_DIR; genpkg main.pacman.txt" \
  gen-pkg-secondary-pacman="cd $PKGLIST_DIR; genpkg secondary.pacman.txt" \
  sync-pkg-main-pacman="cd $PKGLIST_DIR; $PACKAGE_MANAGER -S --needed - < main.pacman.txt" \
  sync-pkg-secondary-pacman="cd $PKGLIST_DIR; $PACKAGE_MANAGER -S --needed - < secondary.pacman.txt" \
  sync-pkg-main-php="cd $PKGLIST_DIR; $PACKAGE_MANAGER -S --needed - < php" \
# TODO: add brew & macports sync
# mac
alias \
  gen-pkg-work-brew="cd $PKGLIST_DIR; brew list > work.brew.txt" \
  gen-pkg-work-macports="cd $PKGLIST_DIR; sudo port installed > work.macports.txt" \
# universal
alias \
  gen-pkg-main-yarn="cd $PKGLIST_DIR; yarn global list --depth=0 | awk '/info/{print $2}' | sed -e 's/\"//g' > main.yarn.txt" \
  gen-pkg-main-php="cd $PKGLIST_DIR; genpkg php 'phpstorm|phpstorm-jre' 'main.php.txt'" \
  sync-pkg-main-yarn="cd $PKGLIST_DIR; cat yarn | xargs -t yarn global add" \

# sync config files
alias \
  sync-cf-src="Lsrdw && cmpl; Lsrdb && cmpl; Lsrdm && cmpl; Lsrst && cmpl; Lsrsx && cmpl" \
  sync-cf-lvim="cd $LVIM_SHARE_DIR && git pull && cd $LVIM_CONFIG_DIR && git pull && lvim +LvimCacheReset +LvimUpdate +PackerSync +PackerCompile" \
  sync-cf-all="git-sync-local-repos; sync-cf-src; sync-cf-lvim; replace-stow-all"

# Git
alias \
  g="git" \

alias \
  sctl="systemctl" \
  sctlu="systemctl --user" \
  ssctl="sudo systemctl" \
  ref="shortcuts >/dev/null; source ${XDG_CONFIG_HOME:-$HOME/.config}/shell/shortcutrc ; source ${XDG_CONFIG_HOME:-$HOME/.config}/shell/zshnameddirrc" \
  wth="less -S ${XDG_DATA_HOME:-$HOME/.local/share}/weatherreport" \
  rates="curl rate.sx | less -S"

# get fastest mirrors
alias \
  update-mirrors="sudo reflector -f 30 -l 30 --number 10 --verbose --save /etc/pacman.d/mirrorlist" \

# For when keys break
alias fix-pkg-keys="sudo pacman-key --init && sudo pacman-key --populate archlinux && sudo pacman-key --refresh-keys"

# pnpm
alias \
  pn="pnpm" \

# yarn
alias \
  yr="yarn" \
  yrt="yarn test --watch --coverage --silent false" \

# composer
alias \
  cs="composer" \
  csi="composer install"

# valet
alias \
  va="valet" \

# youtube
# NOTE: i = ignore errors
# NOTE: x = extract, -f = format
alias \
  yt="yt-dlp --add-metadata -i --cookies-from-browser firefox" \
  yta="yt -x -f bestaudio/best --download-archive playlist.txt" \
  ytap="cat playlist.txt | sed -e 's/youtube /https:\/\/www.youtube.com\/watch?v=/g' | xargs -t yt-dlp --add-metadata -i -x -f bestaudio/best --cookies-from-browser firefox"
alias \
  yta-general="cd ${XDG_MUSIC_DIR:-$HOME/Music}/general; yta 'https://www.youtube.com/playlist?list=PLqQefq-YNypMfVRJJSW10MRaFYARFiL_P'" \
  yta-live="cd ${XDG_MUSIC_DIR:-$HOME/Music}/live; yta 'https://www.youtube.com/playlist?list=PLqQefq-YNypOJjVTvYXW-8ftq2GpnxXVV'" \
  yta-osts="cd ${XDG_MUSIC_DIR:-$HOME/Music}/osts; yta 'https://www.youtube.com/playlist?list=PLqQefq-YNypOhI67WpGJVJyXyBem_VOYZ'" \
  yta-albums="cd ${XDG_MUSIC_DIR:-$HOME/Music}/albums; yta 'https://www.youtube.com/playlist?list=PLqQefq-YNypNxKSWAsR7VQxEY63RK7AwD'" \
  yta-main="yta-general; yta-live; yta-osts; yta-albums"
alias \
  yta-touhou="cd ${XDG_MUSIC_DIR:-$HOME/Music}/touhou; ytap" \
  yta-akatsuki-records="cd ${XDG_MUSIC_DIR:-$HOME/Music}/akatsuki-records; ytap" \
  yta-shield-hero="cd ${XDG_MUSIC_DIR:-$HOME/Music}/rising-of-the-shield-hero; ytap" \
  yta-custom="yta-touhou; yta-akatsuki-records; yta-shield-hero"

# sync replace every config file
alias \
  replace-stow="cd $DOTFILES_DIR && stow --adopt --target=${HOME}" \
  replace-stow-all="replace-stow arch voidrice universal" \

# some programs
alias \
  nf="neofetch" \
  rs="redis-server" \
  lzg="lazygit" \
  lzd="lazydocker" \
  clp="colorpicker --short --one-shot --preview | xsel -b" \

# restart
alias \
  restart-ee="ka easyeffects; nohup easyeffects --gapplication-service &; notify-send 'EasyEffects activated...'" \
  restart-dunst="ka dunst; nohup dunst &; notify-send 'Dunst activated...'" \
  restart-compositor="ka picom; nohup picom --experimental-backend &; notify-send 'Compositor activated...'" \
  restart-nightlight="ka redshift; nohup redshift &; notify-send 'Night light activated...'"

# network
alias \
  myip="curl ifconfig.co" \
  ports="sudo netstat -ntlup" \
  update-hosts="/bin/systemctl restart systemd-hostnamed"

# dynamic folders
alias \
  ff="cd $HOME/.mozilla/firefox/*.dev-edition-default" \
  ffc="cd $HOME/.mozilla/firefox/*.dev-edition-default/chrome"

# misc
alias \
  nohup="nohup >/dev/null 2>&1" \
  sd="nohup $TERMINAL &" \
  ndi="nodemon index.js" \
  cmpl="sudo make && sudo make install" \
  encrypt="gpg -c --no-symkey-cache --cipher-algo AES256" \
  update-grub="sudo grub-mkconfig -o /boot/grub/grub.cfg" \
  init-ctags="ctags -R --exclude=.git" \
  dw="sudo downgrade"
